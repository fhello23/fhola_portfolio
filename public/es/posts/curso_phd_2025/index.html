<!DOCTYPE html>
<html lang="es"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Clase Doctorado UAndes 2025 | FHOLA</title>
<meta property="og:title" content="Clase Doctorado UAndes 2025 | FHOLA" />
<meta name="twitter:title" content="Clase Doctorado UAndes 2025 | FHOLA" />
<meta itemprop="name" content="Clase Doctorado UAndes 2025 | FHOLA" />
<meta name="application-name" content="Clase Doctorado UAndes 2025 | FHOLA" />
<meta property="og:site_name" content="fhola portfolio" />

<meta name="description" content="Guía clase python y napari doctorado UAndes 2025">
<meta itemprop="description" content="Guía clase python y napari doctorado UAndes 2025" />
<meta property="og:description" content="Guía clase python y napari doctorado UAndes 2025" />
<meta name="twitter:description" content="Guía clase python y napari doctorado UAndes 2025" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

  <link rel="alternate" hreflang="es" href="http://localhost:1313/es/posts/curso_phd_2025/" title="Spanish" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/posts/curso_phd_2025/" title="English" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2025-06-17T00:00:00Z />
    <meta property="article:published_time" content=2025-06-17T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/es/posts/curso_phd_2025/" />

    
    <meta property="og:article:author" content="Francisco Hola" />
    <meta property="article:author" content="Francisco Hola" />
    <meta name="author" content="Francisco Hola" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Clase Doctorado UAndes 2025",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2025-06-17",
        "description": "Guía clase python y napari doctorado UAndes 2025",
        "wordCount":  3479 ,
        "mainEntityOfPage": "True",
        "dateModified": "2025-06-17",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "FHOLA"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.123.6">

    
    <meta property="og:title" content="Clase Doctorado UAndes 2025" />
<meta property="og:description" content="Guía clase python y napari doctorado UAndes 2025" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/es/posts/curso_phd_2025/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-06-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-06-17T00:00:00+00:00" />



    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Clase Doctorado UAndes 2025"/>
<meta name="twitter:description" content="Guía clase python y napari doctorado UAndes 2025"/>


    

    <link rel="canonical" href="http://localhost:1313/es/posts/curso_phd_2025/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/es/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/es/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/es/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/es/pages/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
                    <li>
                        <select aria-label="Select Language" class="lang-list" id="select-language" onchange="location = this.value;">
                            
                            
                            
                                
                                
                                    
                                
                                    
                                        
                                        
                                            <option id="es" value="http://localhost:1313/es/posts/curso_phd_2025/" selected>ES
                                            </option>
                                        
                                    
                                
                            
                                
                                
                                    
                                        
                                        
                                            <option id="en" value="http://localhost:1313/posts/curso_phd_2025/">EN</option>
                                        
                                    
                                
                                    
                                
                            
                        </select>                
                    </li>
                    <li class="menu-separator">
                        <span>|</span>
                    </li>
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Clase Doctorado UAndes 2025</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2025-06-17T00:00:00&#43;00:00" itemprop="datePublished"> 17 jun. 2025 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b>Tabla de Contenidos</b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#instalación-python--visual-studio-code--jupyter">Instalación Python + Visual Studio Code + Jupyter</a>
      <ul>
        <li><a href="#instalación-de-python">Instalación de Python</a></li>
        <li><a href="#instalación-de-visual-studio-code-vs-code">Instalación de Visual Studio Code (VS Code)</a></li>
        <li><a href="#configuración-de-vs-code-para-python">Configuración de VS Code para Python</a></li>
        <li><a href="#configuración-de-jupyter-notebooks-en-vs-code">Configuración de Jupyter Notebooks en VS Code</a></li>
        <li><a href="#prueba-python-y-jupyter">Prueba Python y Jupyter</a></li>
      </ul>
    </li>
    <li><a href="#introducción-a-la-visualización-de-datos-con-pandas-y-plotly">Introducción a la Visualización de Datos con Pandas y Plotly</a>
      <ul>
        <li><a href="#dataset-expresión-génica-en-regiones-cerebrales">Dataset: Expresión Génica en Regiones Cerebrales</a></li>
        <li><a href="#configuración-inicial">Configuración Inicial</a>
          <ul>
            <li><a href="#importar-las-librerías-necesarias">Importar las Librerías Necesarias</a></li>
            <li><a href="#cargar-los-datos">Cargar los Datos</a></li>
          </ul>
        </li>
        <li><a href="#exploración-inicial-la-primera-mirada">Exploración Inicial: La Primera Mirada</a>
          <ul>
            <li><a href="#qué-contienen-nuestros-datos">¿Qué Contienen Nuestros Datos?</a></li>
            <li><a href="#resumen-técnico-del-dataset">Resumen Técnico del Dataset</a></li>
            <li><a href="#resumen-estadístico">Resumen Estadístico</a></li>
          </ul>
        </li>
        <li><a href="#análisis-exploratorio-con-pandas">Análisis Exploratorio con Pandas</a>
          <ul>
            <li><a href="#contando-ocurrencias">Contando Ocurrencias</a></li>
            <li><a href="#elementos-únicos">Elementos Únicos</a></li>
          </ul>
        </li>
        <li><a href="#filtrado-y-selección-de-datos">Filtrado y Selección de Datos</a>
          <ul>
            <li><a href="#filtrado-básico">Filtrado Básico</a></li>
            <li><a href="#selección-con-loc--y-iloc">Selección con .loc  y .iloc</a></li>
            <li><a href="#indexación-avanzada">Indexación Avanzada</a></li>
          </ul>
        </li>
        <li><a href="#agrupación-y-agregación">Agrupación y Agregación</a>
          <ul>
            <li><a href="#promedios-por-región">Promedios por Región</a></li>
            <li><a href="#múltiples-agregaciones">Múltiples Agregaciones</a></li>
          </ul>
        </li>
        <li><a href="#creación-de-nuevas-variables">Creación de Nuevas Variables</a>
          <ul>
            <li><a href="#función-para-categorizar-expresión">Función para Categorizar Expresión</a></li>
          </ul>
        </li>
        <li><a href="#visualización-con-plotly">Visualización con Plotly</a>
          <ul>
            <li><a href="#gráfico-de-barras-interactivo">Gráfico de Barras Interactivo</a></li>
            <li><a href="#histograma-de-distribución">Histograma de Distribución</a></li>
            <li><a href="#gráfico-de-violin-distribución-por-región">Gráfico de Violin: Distribución por Región</a></li>
            <li><a href="#mapa-de-calor-heatmap">Mapa de Calor (Heatmap)</a></li>
          </ul>
        </li>
        <li><a href="#análisis-interactivo-avanzado">Análisis Interactivo Avanzado</a>
          <ul>
            <li><a href="#función-para-análisis-por-gen">Función para Análisis por Gen</a></li>
            <li><a href="#top-genes-por-región">Top Genes por Región</a></li>
          </ul>
        </li>
        <li><a href="#manejo-de-datos-faltantes">Manejo de Datos Faltantes</a></li>
        <li><a href="#recursos-adicionales">Recursos Adicionales</a></li>
      </ul>
    </li>
    <li><a href="#introducción-a-napari">Introducción a Napari</a>
      <ul>
        <li><a href="#qué-es-napari">¿Qué es Napari?</a>
          <ul>
            <li><a href="#por-qué-usar-napari">¿Por qué usar Napari?</a></li>
          </ul>
        </li>
        <li><a href="#primeros-pasos-con-napari">Primeros pasos con Napari</a>
          <ul>
            <li><a href="#1-importar-las-librerías-necesarias">1. Importar las librerías necesarias</a></li>
            <li><a href="#2-crear-un-visualizador">2. Crear un visualizador</a></li>
            <li><a href="#3-cargar-datos-de-ejemplo">3. Cargar datos de ejemplo</a></li>
            <li><a href="#4-trabajar-con-capas-layers">4. Trabajar con capas (layers)</a></li>
            <li><a href="#5-examinar-información-detallada-de-una-capa">5. Examinar información detallada de una capa</a></li>
          </ul>
        </li>
        <li><a href="#conceptos-importantes-para-biólogos">Conceptos importantes para biólogos</a>
          <ul>
            <li><a href="#capas-layers">Capas (Layers)</a></li>
            <li><a href="#dimensiones">Dimensiones</a></li>
            <li><a href="#interactividad">Interactividad</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#trabajando-con-archivos-lif-en-napari">Trabajando con Archivos LIF en Napari</a>
      <ul>
        <li><a href="#prerrequisitos">Prerrequisitos</a></li>
        <li><a href="#configurando-el-entorno">Configurando el Entorno</a></li>
        <li><a href="#creando-un-visor-de-napari">Creando un Visor de Napari</a></li>
        <li><a href="#cargando-un-archivo-lif">Cargando un Archivo LIF</a></li>
        <li><a href="#explorando-las-dimensiones-de-la-imagen">Explorando las Dimensiones de la Imagen</a></li>
        <li><a href="#obteniendo-datos-de-imagen">Obteniendo Datos de Imagen</a></li>
        <li><a href="#trabajando-con-múltiples-escenas">Trabajando con Múltiples Escenas</a></li>
        <li><a href="#seleccionando-y-cargando-una-escena-específica">Seleccionando y Cargando una Escena Específica</a></li>
        <li><a href="#visualizando-en-napari">Visualizando en Napari</a></li>
        <li><a href="#entendiendo-la-interfaz-de-napari">Entendiendo la Interfaz de Napari</a></li>
        <li><a href="#consejos-para-trabajar-con-datos-multi-dimensionales">Consejos para Trabajar con Datos Multi-dimensionales</a></li>
      </ul>
    </li>
    <li><a href="#napari--cellpose-segmentación-automática-de-células">Napari + Cellpose: Segmentación Automática de Células</a>
      <ul>
        <li><a href="#qué-es-cellpose">¿Qué es Cellpose?</a>
          <ul>
            <li><a href="#por-qué-combinar-napari-con-cellpose">¿Por qué combinar Napari con Cellpose?</a></li>
          </ul>
        </li>
        <li><a href="#preparación-del-entorno">Preparación del entorno</a>
          <ul>
            <li><a href="#1-importar-las-librerías-necesarias-1">1. Importar las librerías necesarias</a></li>
            <li><a href="#2-crear-el-visualizador-y-cargar-el-modelo">2. Crear el visualizador y cargar el modelo</a></li>
          </ul>
        </li>
        <li><a href="#análisis-paso-a-paso">Análisis paso a paso</a>
          <ul>
            <li><a href="#3-cargar-tu-imagen">3. Cargar tu imagen</a></li>
            <li><a href="#4-ejecutar-la-segmentación-automática">4. Ejecutar la segmentación automática</a></li>
            <li><a href="#5-visualizar-los-resultados">5. Visualizar los resultados</a></li>
          </ul>
        </li>
        <li><a href="#análisis-cuantitativo">Análisis cuantitativo</a>
          <ul>
            <li><a href="#6-extraer-medidas-de-las-células">6. Extraer medidas de las células</a></li>
            <li><a href="#7-exportar-imágenes-para-presentaciones">7. Exportar imágenes para presentaciones</a></li>
          </ul>
        </li>
        <li><a href="#consejos-para-optimizar-resultados">Consejos para optimizar resultados</a>
          <ul>
            <li><a href="#ajustar-el-diámetro">Ajustar el diámetro</a></li>
            <li><a href="#seleccionar-el-modelo-apropiado">Seleccionar el modelo apropiado</a></li>
            <li><a href="#configurar-canales-correctamente">Configurar canales correctamente</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <h2 id="instalación-python--visual-studio-code--jupyter">Instalación Python + Visual Studio Code + Jupyter</h2>
<p>Cubro la instalación, tanto para Windows como para Mac en un video públicado en el siguiente <a href="https://youtu.be/zJJ92NXcPc0">link</a>. Si prefieres la versión escrita, te dejo este instructivo a continuación:</p>
<h3 id="instalación-de-python">Instalación de Python</h3>
<p>Python es un lenguaje de programación versátil. Instalaremos la última versión estable.</p>
<p><strong>Descargar Python:</strong></p>
<ul>
<li>
<p>Abran su navegador web y vayan al sitio web oficial de Python: <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
</li>
<li>
<p>El sitio web debería detectar automáticamente su sistema operativo (Windows o macOS) y sugerir el instalador apropiado. Hagan clic en el botón de descarga para la última versión (por ejemplo, Python 3.12.x o más reciente).</p>
</li>
</ul>
<p><strong>Instalar Python:</strong></p>
<ul>
<li><strong>Para Usuarios de Windows:</strong></li>
</ul>
<ol>
<li>Ejecuten el instalador <code>.exe</code> descargado.</li>
<li><strong>Paso Crucial:</strong> En la primera pantalla del instalador, asegúrense de marcar la casilla que dice <strong>&ldquo;Add Python to PATH&rdquo;</strong> o <strong>&ldquo;Add python.exe to PATH&rdquo;</strong>. Esto facilitará la ejecución de Python desde la línea de comandos.</li>
<li>Hagan clic en <strong>&ldquo;Install Now&rdquo;</strong> (esto usualmente incluye pip, IDLE y otras características estándar).</li>
<li>Sigan las instrucciones en pantalla para completar la instalación.</li>
<li>Una vez instalado, podrían ver una opción para &ldquo;Disable path length limit&rdquo;. Hagan clic en esto si está disponible, ya que puede prevenir problemas con rutas de archivo largas.</li>
</ol>
<ul>
<li><strong>Para Usuarios de macOS:</strong></li>
</ul>
<ol>
<li>Ejecuten el instalador <code>.pkg</code> descargado.</li>
<li>Sigan las instrucciones en pantalla. Python en macOS usualmente se instala sin problemas. Se instalará en <code>/usr/local/bin/python3</code>.</li>
<li>El instalador también debería instalar <code>pip</code> (el instalador de paquetes de Python) e <code>IDLE</code> (el Entorno de Desarrollo Integrado básico de Python).</li>
</ol>
<p><strong>Verificar la Instalación de Python:</strong></p>
<ul>
<li>
<p>Una vez completada la instalación, necesitan verificarla.</p>
</li>
<li>
<p><strong>Para Windows:</strong></p>
</li>
</ul>
<ol>
<li>Abran el Símbolo del sistema (busquen &ldquo;cmd&rdquo; en el Menú Inicio).</li>
<li>Escriban <code>python --version</code> y presionen Enter.</li>
<li>Escriban <code>pip --version</code> y presionen Enter.</li>
</ol>
<p>Deberían ver las versiones de Python y pip impresas, respectivamente.</p>
<ul>
<li><strong>Para macOS:</strong></li>
</ul>
<ol>
<li>Abran la Terminal (pueden encontrarla en Aplicaciones &gt; Utilidades, o buscarla usando Spotlight).</li>
<li>Escriban <code>python3 --version</code> y presionen Enter.</li>
<li>Escriban <code>pip3 --version</code> y presionen Enter.</li>
</ol>
<p>Deberían ver las versiones de Python y pip impresas. (Nota: macOS a menudo viene con una versión más antigua de Python 2, por lo que <code>python3</code> y <code>pip3</code> se usan típicamente para especificar la versión que acaban de instalar).</p>
<p>Si ven los números de versión, ¡Python está instalado correctamente! Si no, intenten reiniciar su computadora y verificar nuevamente. Si los problemas persisten, podrían necesitar reinstalar, asegurándose de haber agregado Python al PATH en Windows.</p>
<h3 id="instalación-de-visual-studio-code-vs-code">Instalación de Visual Studio Code (VS Code)</h3>
<p>VS Code es un editor de código fuente ligero pero potente que se ejecuta en su escritorio y está disponible para Windows, macOS y Linux. Tiene un excelente soporte para el desarrollo en Python.</p>
<p><strong>Descargar VS Code:</strong></p>
<ul>
<li>Vayan al sitio web oficial de VS Code: <a href="https://code.visualstudio.com/download">https://code.visualstudio.com/download</a></li>
<li>Descarguen el instalador para su sistema operativo (Windows o macOS).</li>
</ul>
<p><strong>Instalar VS Code:</strong></p>
<ul>
<li><strong>Para Windows:</strong></li>
</ul>
<ol>
<li>Ejecuten el instalador <code>.exe</code> descargado.</li>
<li>Acepten el acuerdo y sigan las instrucciones en pantalla.</li>
<li>Se recomienda mantener la configuración predeterminada, especialmente <strong>&ldquo;Add to PATH&rdquo;</strong> (si se ofrece como opción durante la instalación, asegúrense de que esté marcada).</li>
<li>También podrían querer marcar las acciones &ldquo;Open with Code&rdquo; (&ldquo;Abrir con Code&rdquo;) para el menú contextual de archivos y directorios del Explorador de Windows por conveniencia.</li>
</ol>
<ul>
<li><strong>Para macOS:</strong></li>
</ul>
<ol>
<li>Ejecuten el archivo <code>.dmg</code> descargado.</li>
<li>Arrastren el ícono &ldquo;Visual Studio Code.app&rdquo; a su carpeta de &ldquo;Aplicaciones&rdquo;.</li>
</ol>
<p><strong>Iniciar VS Code:</strong></p>
<ul>
<li>Abran VS Code desde su carpeta de Aplicaciones (macOS) o Menú Inicio (Windows).</li>
</ul>
<h3 id="configuración-de-vs-code-para-python">Configuración de VS Code para Python</h3>
<p>Ahora, configuremos VS Code para que funcione con Python.</p>
<p><strong>Instalar la Extensión de Python:</strong></p>
<ul>
<li>En VS Code, vayan a la <strong>Vista de Extensiones</strong> haciendo clic en el ícono de cuadrados en la barra lateral izquierda (o presionen <code>Ctrl+Shift+X</code> en Windows, <code>Cmd+Shift+X</code> en macOS).</li>
<li>En la barra de búsqueda, escriban <code>Python</code>.</li>
<li>Busquen la extensión llamada <strong>&ldquo;Python&rdquo;</strong> publicada por <strong>Microsoft</strong>. Usualmente es el primer resultado y tiene millones de descargas.</li>
<li>Hagan clic en el botón <strong>&ldquo;Install&rdquo;</strong> (Instalar) para esta extensión.</li>
</ul>
<h3 id="configuración-de-jupyter-notebooks-en-vs-code">Configuración de Jupyter Notebooks en VS Code</h3>
<p>Los Jupyter Notebooks son documentos interactivos que permiten escribir y ejecutar código, agregar texto, ecuaciones, visualizaciones y más. VS Code tiene un excelente soporte incorporado para Jupyter Notebooks.</p>
<p><strong>Instalar la Extensión Jupyter:</strong></p>
<ul>
<li>Al igual que instalaron la extensión de Python, vayan a la <strong>Vista de Extensiones</strong> (<code>Ctrl+Shift+X</code> o <code>Cmd+Shift+X</code>).</li>
<li>Busquen <code>Jupyter</code>.</li>
<li>Instalen la extensión <strong>&ldquo;Jupyter&rdquo;</strong> publicada por <strong>Microsoft</strong>. (A menudo, esta se instala como una dependencia de la extensión de Python, pero es bueno verificar).</li>
</ul>
<p><strong>Crear o Abrir un Jupyter Notebook:</strong></p>
<ul>
<li>Crea un archivo de prueba, llamado <code>prueba.ipynb</code>. Este es el nombre de extensión de los cuadernos de jupyter.</li>
</ul>
<p><strong>Seleccionar un Kernel:</strong></p>
<ul>
<li>El notebook necesitará conectarse a un &ldquo;kernel&rdquo; (núcleo) de Python para ejecutar código.</li>
<li>Usualmente, en la parte superior derecha de la interfaz del notebook, verán una opción para &ldquo;Select Kernel&rdquo; (Seleccionar Kernel).</li>
<li>Hagan clic allí y elijan el entorno de Python que configuraron anteriormente (el mismo que seleccionaron como su intérprete de Python).</li>
<li>Si se les solicita instalar <code>ipykernel</code> u otros paquetes, permitan que la extensión lo haga.</li>
</ul>
<p><strong>Usar el Notebook:</strong></p>
<ul>
<li>Un notebook está hecho de &ldquo;celdas&rdquo;.</li>
<li><strong>Celdas de código:</strong> Donde escriben y ejecutan código Python. Escriban su código y presionen <code>Shift+Enter</code> (o hagan clic en el botón de reproducir junto a la celda) para ejecutarlo.</li>
<li><strong>Celdas de Markdown:</strong> Donde pueden escribir texto, como esta guía. Pueden cambiar el tipo de celda usando el menú desplegable en la barra de herramientas del notebook.</li>
</ul>
<hr>
<h3 id="prueba-python-y-jupyter">Prueba Python y Jupyter</h3>
<p>Asegurémonos de que todo funcione.</p>
<p><strong>Script de Python Simple en VS Code:</strong></p>
<ul>
<li>Creen un nuevo archivo en VS Code (File &gt; New File o Archivo &gt; Nuevo Archivo).</li>
<li>Guárdenlo como <code>hola.py</code>.</li>
<li>Escriban el siguiente código Python:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;¡Hola, desde un script de Python!&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>Guarden el archivo (<code>Ctrl+S</code> o <code>Cmd+S</code>).</li>
<li>Hagan clic derecho en el editor y seleccionen &ldquo;Run Python File in Terminal&rdquo; (Ejecutar Archivo Python en Terminal) o hagan clic en el botón de reproducir en la parte superior derecha de la ventana de VS Code.</li>
<li>Deberían ver el mensaje impreso en el panel de la terminal de VS Code.</li>
</ul>
<p><strong>Prueba Simple de Jupyter Notebook:</strong></p>
<ul>
<li>Si no tienen un Jupyter Notebook abierto, creen uno (<code>Jupyter: Create New Jupyter Notebook</code> desde la Paleta de Comandos).</li>
<li>En la primera celda de código, escriban:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&#34;¡Hola desde una celda de Jupyter Notebook!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">mensaje</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>Presionen <code>Shift+Enter</code> para ejecutar la celda.</li>
<li>Deberían ver la salida <code>¡Hola desde una celda de Jupyter Notebook!</code> mostrada directamente debajo de la celda.</li>
</ul>
<h2 id="introducción-a-la-visualización-de-datos-con-pandas-y-plotly">Introducción a la Visualización de Datos con Pandas y Plotly</h2>
<p>La ciencia de datos moderna requiere herramientas poderosas para el análisis y visualización de información. En este tutorial completo, exploraremos dos de las librerías más importantes del ecosistema Python para análisis de datos: <strong>Pandas</strong> para manipulación de datos y <strong>Plotly</strong> para visualizaciones interactivas.</p>
<h3 id="dataset-expresión-génica-en-regiones-cerebrales">Dataset: Expresión Génica en Regiones Cerebrales</h3>
<p>Para esta sección utilizaremos un dataset real del <strong>Human Protein Atlas</strong> que contiene información sobre la expresión de genes en diferentes regiones del cerebro humano. Este tipo de datos es crucial para entender cómo funcionan los genes en diferentes partes del cerebro.</p>
<h3 id="configuración-inicial">Configuración Inicial</h3>
<h4 id="importar-las-librerías-necesarias">Importar las Librerías Necesarias</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></div><p><strong>¿Por qué estas librerías?</strong></p>
<ul>
<li>
<p><strong>Pandas</strong>: La herramienta fundamental para manipulación de datos en Python</p>
</li>
<li>
<p><strong>Plotly Express</strong>: Para crear visualizaciones rápidas e interactivas</p>
</li>
<li>
<p><strong>Plotly Graph Objects</strong>: Para visualizaciones más personalizadas</p>
</li>
<li>
<p><strong>NumPy</strong>: Para operaciones matemáticas y manejo de arrays</p>
</li>
</ul>
<h4 id="cargar-los-datos">Cargar los Datos</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rna_brain_region_hpa.csv&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="exploración-inicial-la-primera-mirada">Exploración Inicial: La Primera Mirada</h3>
<h4 id="qué-contienen-nuestros-datos">¿Qué Contienen Nuestros Datos?</h4>
<p>Antes de analizar, debemos entender qué estamos manejando:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Mostrar las primeras 10 filas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="resumen-técnico-del-dataset">Resumen Técnico del Dataset</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Información general sobre el dataset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>¿Qué nos dice esto?</strong></p>
<ul>
<li>
<p>Número total de filas y columnas</p>
</li>
<li>
<p>Tipos de datos en cada columna</p>
</li>
<li>
<p>Valores nulos (si los hay)</p>
</li>
<li>
<p>Uso de memoria</p>
</li>
</ul>
<h4 id="resumen-estadístico">Resumen Estadístico</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Estadísticas descriptivas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>Información clave:</strong></p>
<ul>
<li>Medidas de tendencia central (media, mediana)</li>
<li>Dispersión de los datos (desviación estándar)</li>
<li>Valores mínimos y máximos</li>
<li>Percentiles (25%, 50%, 75%)</li>
</ul>
<h3 id="análisis-exploratorio-con-pandas">Análisis Exploratorio con Pandas</h3>
<h4 id="contando-ocurrencias">Contando Ocurrencias</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ¿Cuántas muestras tenemos por región cerebral?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="elementos-únicos">Elementos Únicos</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de genes únicos: </span><span class="si">{</span><span class="n">brain_data</span><span class="p">[</span><span class="s2">&#34;Gene name&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Número de regiones cerebrales únicas: </span><span class="si">{</span><span class="n">brain_data</span><span class="p">[</span><span class="s2">&#34;Brain region&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="filtrado-y-selección-de-datos">Filtrado y Selección de Datos</h3>
<h4 id="filtrado-básico">Filtrado Básico</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Filtrar datos solo del cerebelo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cerebellum</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cerebellum&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Genes con alta expresión (TPM &gt; 100)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">high_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;TPM&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>
</span></span></code></pre></div><h4 id="selección-con-loc--y-iloc">Selección con .loc  y .iloc</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Selección basada en etiquetas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">specific_gene</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TNMD&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Selección basada en posición</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">first_rows_cols</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span></span></code></pre></div><h4 id="indexación-avanzada">Indexación Avanzada</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Crear índice multi-nivel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_indexed</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span> <span class="s1">&#39;Brain region&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Acceder a datos específicos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gene_tpm</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;TNMD&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebellum&#39;</span><span class="p">),</span> <span class="s1">&#39;TPM&#39;</span><span class="p">]</span>
</span></span></code></pre></div><h3 id="agrupación-y-agregación">Agrupación y Agregación</h3>
<h4 id="promedios-por-región">Promedios por Región</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Expresión promedio por región cerebral</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">avg_expression_by_region</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="múltiples-agregaciones">Múltiples Agregaciones</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Mediana y suma por región</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">median_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sum_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="creación-de-nuevas-variables">Creación de Nuevas Variables</h3>
<h4 id="función-para-categorizar-expresión">Función para Categorizar Expresión</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">nivel_de_expresion</span><span class="p">(</span><span class="n">tpm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">tpm</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;Baja&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="n">tpm</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;Media&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;Alta&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Aplicar la función</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;nivel_de_expresion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;TPM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nivel_de_expresion</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="visualización-con-plotly">Visualización con Plotly</h3>
<h4 id="gráfico-de-barras-interactivo">Gráfico de Barras Interactivo</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gen</span> <span class="o">=</span> <span class="s2">&#34;GFAP&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_filtrado_por_gen</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gen</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_filtrado_por_gen</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Expresión de </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s1"> en Diferentes Regiones Cerebrales&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TPM&#39;</span><span class="p">:</span> <span class="s1">&#39;TPM (Transcritos Por Millón)&#39;</span><span class="p">,</span> <span class="s1">&#39;Brain region&#39;</span><span class="p">:</span> <span class="s1">&#39;Región Cerebral&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span> <span class="c1"># Rotar las etiquetas del eje x para una mejor legibilidad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="histograma-de-distribución">Histograma de Distribución</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">brain_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribución de la Expresión Génica (TPM)&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TPM&#39;</span><span class="p">:</span> <span class="s1">&#39;TPM (Transcritos Por Millón)&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Usar una escala logarítmica en el eje y para ver el rango completo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nbins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Aumentar el número de &#34;bins&#34; o intervalos para más detalle</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="gráfico-de-violin-distribución-por-región">Gráfico de Violin: Distribución por Región</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">violin</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribución de Expresión por Región Cerebral&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">box</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="mapa-de-calor-heatmap">Mapa de Calor (Heatmap)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Seleccionar genes de interés</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">genes_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OLIG2&#39;</span><span class="p">,</span> <span class="s1">&#39;RBM6&#39;</span><span class="p">,</span> <span class="s1">&#39;GDE1&#39;</span><span class="p">,</span> <span class="s1">&#39;TSPAN6&#39;</span><span class="p">,</span> <span class="s1">&#39;CYP51A1&#39;</span><span class="p">,</span> <span class="s1">&#39;HS3ST1&#39;</span><span class="p">,</span> <span class="s1">&#39;SPAST&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">heatmap_df</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">genes_of_interest</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Debemos &#34;pivotar&#34; la tabla para obtener la forma correcta para un mapa de calor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">heatmap_pivot</span> <span class="o">=</span> <span class="n">heatmap_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;nTPM&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">heatmap_pivot</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mapa de Calor de Expresión Génica de Marcadores Neuronales&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&#34;Región Cerebral&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&#34;Nombre del Gen&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;nTPM&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">color_continuous_scale</span><span class="o">=</span><span class="s2">&#34;plasma&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># zmin=0, # Establecer límite inferior de la escala</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># zmax=100 # Establecer límite superior de la escala</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="análisis-interactivo-avanzado">Análisis Interactivo Avanzado</h3>
<h4 id="función-para-análisis-por-gen">Función para Análisis por Gen</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">analizar_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">	<span class="n">df_filtrado</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gen</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">df_filtrado</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Gen &#39;</span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s2">&#39; no encontrado en el dataset&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="n">df_filtrado</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Expresión del Gen </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="s1"> por Región Cerebral&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">color</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">df_filtrado</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ejemplo de uso</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">resultado</span> <span class="o">=</span> <span class="n">analizar_gen</span><span class="p">(</span><span class="s1">&#39;ACTB&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="top-genes-por-región">Top Genes por Región</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">top_genes_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">	
</span></span></span><span class="line"><span class="cl"><span class="s2">	Encuentra los genes más expresados en una región específica
</span></span></span><span class="line"><span class="cl"><span class="s2">	
</span></span></span><span class="line"><span class="cl"><span class="s2">	&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">top_genes</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>\
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pTPM&#39;</span><span class="p">,</span> <span class="s1">&#39;TPM&#39;</span><span class="p">,</span> <span class="s1">&#39;nTPM&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">top_genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> Genes Más Expresados en </span><span class="si">{</span><span class="n">region</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">color</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">top_genes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ejemplo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">top_cerebellum</span> <span class="o">=</span> <span class="n">top_genes_region</span><span class="p">(</span><span class="s1">&#39;cerebellum&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="manejo-de-datos-faltantes">Manejo de Datos Faltantes</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Verificar datos nulos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Datos nulos por columna:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">brain_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># En caso de tener datos nulos:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># brain_data.dropna() # Eliminar filas con valores nulos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># brain_data.fillna(0) # Reemplazar con 0</span>
</span></span></code></pre></div><h3 id="recursos-adicionales">Recursos Adicionales</h3>
<ul>
<li>
<p><a href="https://pandas.pydata.org/docs/">Documentación oficial de Pandas</a></p>
</li>
<li>
<p><a href="https://plotly.com/python/">Galería de ejemplos de Plotly</a></p>
</li>
<li>
<p><a href="https://www.proteinatlas.org/">Human Protein Atlas</a></p>
</li>
</ul>
<h2 id="introducción-a-napari">Introducción a Napari</h2>
<h3 id="qué-es-napari">¿Qué es Napari?</h3>
<p>Napari es una herramienta de visualización rápida, interactiva y multidimensional para Python, especialmente diseñada para datos científicos. Es perfecta para analizar imágenes biológicas como microscopía, datos de fluorescencia, y cualquier tipo de imagen científica en 2D, 3D o incluso dimensiones superiores.</p>
<h4 id="por-qué-usar-napari">¿Por qué usar Napari?</h4>
<ul>
<li>
<p><strong>Interactivo</strong>: Puedes explorar tus datos de forma visual e interactiva</p>
</li>
<li>
<p><strong>Multidimensional</strong>: Maneja datos 2D, 3D, 4D y más dimensiones</p>
</li>
<li>
<p><strong>Extensible</strong>: Compatible con muchas herramientas de análisis de imágenes</p>
</li>
<li>
<p><strong>Fácil de usar</strong>: Interfaz intuitiva para científicos</p>
</li>
</ul>
<h3 id="primeros-pasos-con-napari">Primeros pasos con Napari</h3>
<h4 id="1-importar-las-librerías-necesarias">1. Importar las librerías necesarias</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.filters</span> <span class="kn">import</span> <span class="n">threshold_otsu</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.segmentation</span> <span class="kn">import</span> <span class="n">clear_border</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">regionprops_table</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <span class="n">closing</span><span class="p">,</span> <span class="n">square</span><span class="p">,</span> <span class="n">remove_small_objects</span>
</span></span></code></pre></div><p><strong>Explicación:</strong></p>
<ul>
<li>
<p><code>napari</code>: La librería principal para visualización</p>
</li>
<li>
<p><code>skimage</code>: Librería de procesamiento de imágenes (scikit-image)</p>
</li>
<li>
<p><code>numpy</code>: Para manejo de arrays y datos numéricos</p>
</li>
</ul>
<h4 id="2-crear-un-visualizador">2. Crear un visualizador</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span></code></pre></div><p>Este comando abre una ventana interactiva donde podrás visualizar y manipular tus datos. Es como abrir un microscopio digital en tu computadora.</p>
<h4 id="3-cargar-datos-de-ejemplo">3. Cargar datos de ejemplo</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cells3d</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;celulas&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>¿Qué hace este código?</strong></p>
<ul>
<li>
<p><code>data.cells3d()</code>: Carga un conjunto de datos de ejemplo que contiene células en 3D</p>
</li>
<li>
<p><code>add_image()</code>: Añade la imagen al visualizador</p>
</li>
<li>
<p><code>name='celulas'</code>: Le da un nombre descriptivo a la capa</p>
</li>
</ul>
<h4 id="4-trabajar-con-capas-layers">4. Trabajar con capas (layers)</h4>
<p>En Napari, cada elemento visual es una &ldquo;capa&rdquo; o &ldquo;layer&rdquo;. Puedes tener múltiples capas superpuestas. Puedes agregar puntos desde el GUI por ejemplo y podremos accederlos desde nuestro notebook:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Obtener todas las capas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">layers</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Resultado esperado:</strong></p>
<pre tabindex="0"><code>
[&lt;Image layer &#39;celulas&#39; at 0x35ca7d040&gt;,

  

&lt;Points layer &#39;Points&#39; at 0x355315eb0&gt;,

  
</code></pre><h4 id="5-examinar-información-detallada-de-una-capa">5. Examinar información detallada de una capa</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Seleccionar una capa específica (en este caso, la capa de puntos)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">points_layer</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Obtener información detallada</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Nombre de la capa: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Tipo de capa: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">points_layer</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Forma de los datos: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Tipo de datos: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Número de puntos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Visibilidad: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">visible</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Opacidad: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">opacity</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ver las coordenadas de los puntos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Coordenadas de los puntos:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Resultado esperado:</strong></p>
<pre tabindex="0"><code>
Nombre de la capa: Points

  

Tipo de capa: &lt;class &#39;napari.layers.points.points.Points&#39;&gt;

  

Forma de los datos: (4, 4)

  

Tipo de datos: float64

  

Número de puntos: 4

  

Visibilidad: True

  

Opacidad: 1.0

  

  

Coordenadas de los puntos:

  

[Lista con coordenadas de puntos agregados]

  
</code></pre><h3 id="conceptos-importantes-para-biólogos">Conceptos importantes para biólogos</h3>
<h4 id="capas-layers">Capas (Layers)</h4>
<ul>
<li>
<p><strong>Image layers</strong>: Para mostrar imágenes (microscopía, fluorescencia, etc.)</p>
</li>
<li>
<p><strong>Points layers</strong>: Para marcar puntos específicos (células, orgánulos, etc.)</p>
</li>
<li>
<p><strong>Labels layers</strong>: Para segmentación y regiones de interés</p>
</li>
<li>
<p><strong>Shapes layers</strong>: Para dibujar formas geométricas</p>
</li>
</ul>
<h4 id="dimensiones">Dimensiones</h4>
<ul>
<li>
<p><strong>2D</strong>: Imágenes simples (x, y)</p>
</li>
<li>
<p><strong>3D</strong>: Stacks de imágenes o volúmenes (z, y, x)</p>
</li>
<li>
<p><strong>4D</strong>: Series temporales (t, z, y, x)</p>
</li>
<li>
<p><strong>Multi-canal</strong>: Diferentes canales de fluorescencia</p>
</li>
</ul>
<h4 id="interactividad">Interactividad</h4>
<ul>
<li>
<p>Usa el mouse para navegar por las imágenes</p>
</li>
<li>
<p>Controles de zoom y paneo</p>
</li>
<li>
<p>Ajuste de contraste y brillo</p>
</li>
<li>
<p>Navegación por capas en 3D</p>
</li>
</ul>
<h2 id="trabajando-con-archivos-lif-en-napari">Trabajando con Archivos LIF en Napari</h2>
<h3 id="prerrequisitos">Prerrequisitos</h3>
<p>Antes de comenzar, asegúrate de tener los paquetes necesarios instalados:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pip install napari aicsimageio scikit-image
</span></span></code></pre></div><h3 id="configurando-el-entorno">Configurando el Entorno</h3>
<p>Primero, importemos las librerías necesarias:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">aicsimageio</span> <span class="kn">import</span> <span class="n">AICSImage</span>
</span></span></code></pre></div><h3 id="creando-un-visor-de-napari">Creando un Visor de Napari</h3>
<p>Comienza creando una instancia del visor de napari:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span></code></pre></div><p>Esto abre la interfaz de napari donde visualizaremos nuestros datos de imagen.</p>
<h3 id="cargando-un-archivo-lif">Cargando un Archivo LIF</h3>
<p>Carga tu archivo LIF usando AICSImage:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">AICSImage</span><span class="p">(</span><span class="s2">&#34;./lif_test.lif&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Reemplaza <code>&quot;./lif_test.lif&quot;</code> con la ruta a tu archivo LIF.</p>
<h3 id="explorando-las-dimensiones-de-la-imagen">Explorando las Dimensiones de la Imagen</h3>
<p>Verifica las dimensiones de tu imagen cargada:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span></span></code></pre></div><p>Esto mostrará algo como:</p>
<pre tabindex="0"><code>
&lt;Dimensions [T: 1, C: 4, Z: 8, Y: 512, X: 512]&gt;
</code></pre><h3 id="obteniendo-datos-de-imagen">Obteniendo Datos de Imagen</h3>
<p>Extrae los datos de imagen para análisis:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span></code></pre></div><p>El parámetro <code>&quot;CZYX&quot;</code> especifica el orden de las dimensiones:</p>
<ul>
<li>
<p><strong>C</strong>: Canales primero</p>
</li>
<li>
<p><strong>Z</strong>: Planos Z segundo</p>
</li>
<li>
<p><strong>Y</strong>: Altura tercero</p>
</li>
<li>
<p><strong>X</strong>: Ancho cuarto</p>
</li>
</ul>
<h3 id="trabajando-con-múltiples-escenas">Trabajando con Múltiples Escenas</h3>
<p>Los archivos LIF a menudo contienen múltiples escenas (diferentes campos de vista o condiciones experimentales). Exploremos qué está disponible:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Imprimir todas las escenas disponibles</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Número total de series en el archivo: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Esto te mostrará todos los nombres de escenas en tu archivo LIF, como:</p>
<pre tabindex="0"><code>
(&#39;LPS SYN settings&#39;, &#39;LPS SYN 0&#39;, &#39;LPS SYN 1.1&#39;, &#39;LPS SYN 1.2&#39;, ...)

Número total de series en el archivo: 119
</code></pre><h3 id="seleccionando-y-cargando-una-escena-específica">Seleccionando y Cargando una Escena Específica</h3>
<p>Elige una escena específica con la que trabajar:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Seleccionar una escena por índice</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scene_index</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Cambia esto para cargar diferentes escenas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">selected_scene</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="n">scene_index</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Escena seleccionada: </span><span class="si">{</span><span class="n">selected_scene</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Establecer la escena actual en el objeto AICSImage</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">scene_index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Obtener los datos de imagen para la escena seleccionada</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Imprimir dimensiones para esta escena</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Número total de canales C: </span><span class="si">{</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Número total de planos Z: </span><span class="si">{</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="visualizando-en-napari">Visualizando en Napari</h3>
<p>Finalmente, carga los datos de imagen en napari para visualización:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Limpiar cualquier capa anterior</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Agregar la imagen con organización apropiada de canales y planos z</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># La primera dimensión (C) es el canal</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;Escena: </span><span class="si">{</span><span class="n">selected_scene</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scale</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># Escala para dimensiones Z, Y, X</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><h3 id="entendiendo-la-interfaz-de-napari">Entendiendo la Interfaz de Napari</h3>
<p>Una vez cargado, verás:</p>
<ol>
<li>
<p><strong>Controles de Canal</strong>: Deslizadores y controles para cada canal (dimensión C)</p>
</li>
<li>
<p><strong>Navegación de Plano Z</strong>: Deslizador para navegar a través del z-stack (dimensión Z)</p>
</li>
<li>
<p><strong>Capas de Canal Individuales</strong>: Cada canal aparece como una capa separada en la lista de capas</p>
</li>
<li>
<p><strong>Controles de Visualización</strong>: Opciones de contraste, mapa de colores y mezcla para cada canal</p>
</li>
</ol>
<h3 id="consejos-para-trabajar-con-datos-multi-dimensionales">Consejos para Trabajar con Datos Multi-dimensionales</h3>
<ol>
<li><strong>Visualización de Canales</strong>: Cada canal se mostrará como una capa separada, permitiéndote:</li>
</ol>
<ul>
<li>
<p>Activar/desactivar canales</p>
</li>
<li>
<p>Ajustar contraste y brillo individualmente</p>
</li>
<li>
<p>Cambiar mapas de colores para mejor visualización</p>
</li>
</ul>
<ol start="2">
<li>
<p><strong>Navegación de Z-stack</strong>: Usa el deslizador z para navegar a través de diferentes planos focales</p>
</li>
<li>
<p><strong>Comparación de Escenas</strong>: Para comparar diferentes escenas:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cargar múltiples escenas para comparación</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]:</span> <span class="c1"># Ejemplo de índices de escenas</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;Escena: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="4">
<li><strong>Gestión de Memoria</strong>: Para archivos grandes con muchas escenas:</li>
</ol>
<ul>
<li>
<p>Carga escenas individualmente en lugar de todas a la vez</p>
</li>
<li>
<p>Limpia el visor entre escenas si es necesario: <code>viewer.layers.clear()</code></p>
</li>
</ul>
<h2 id="napari--cellpose-segmentación-automática-de-células">Napari + Cellpose: Segmentación Automática de Células</h2>
<h3 id="qué-es-cellpose">¿Qué es Cellpose?</h3>
<p>Cellpose es una herramienta de inteligencia artificial desarrollada específicamente para la segmentación automática de células en imágenes de microscopía. Utiliza redes neuronales entrenadas para identificar y delimitar células individuales, incluso en imágenes complejas con células superpuestas o de formas irregulares.</p>
<h4 id="por-qué-combinar-napari-con-cellpose">¿Por qué combinar Napari con Cellpose?</h4>
<ul>
<li>
<p><strong>Automatización</strong>: Segmentación automática sin necesidad de ajuste manual</p>
</li>
<li>
<p><strong>Precisión</strong>: Modelos entrenados con miles de imágenes biológicas</p>
</li>
<li>
<p><strong>Visualización</strong>: Napari permite visualizar y validar los resultados de segmentación</p>
</li>
<li>
<p><strong>Análisis cuantitativo</strong>: Extracción automática de medidas y propiedades celulares</p>
</li>
<li>
<p><strong>Exportación</strong>: Guarda resultados para análisis posteriores</p>
</li>
</ul>
<h3 id="preparación-del-entorno">Preparación del entorno</h3>
<h4 id="1-importar-las-librerías-necesarias-1">1. Importar las librerías necesarias</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ssl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cellpose</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">regionprops_table</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Explicación:</strong></p>
<ul>
<li>
<p><code>ssl</code>: Configuración para descargar modelos de Cellpose</p>
</li>
<li>
<p><code>napari</code>: Visualización interactiva</p>
</li>
<li>
<p><code>skimage.io</code>: Lectura de imágenes</p>
</li>
<li>
<p><code>cellpose.models</code>: Modelos de segmentación automática</p>
</li>
<li>
<p><code>pandas</code>: Manejo de datos tabulares</p>
</li>
<li>
<p><code>regionprops_table</code>: Cálculo de propiedades de regiones</p>
</li>
</ul>
<h4 id="2-crear-el-visualizador-y-cargar-el-modelo">2. Crear el visualizador y cargar el modelo</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Crear el visualizador de Napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configurar y cargar el modelo de Cellpose</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Cellpose</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s2">&#34;cyto&#34;</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>¿Qué hace este código?</strong></p>
<ul>
<li>
<p><code>napari.Viewer()</code>: Abre la interfaz gráfica</p>
</li>
<li>
<p><code>model_type=&quot;cyto&quot;</code>: Usa el modelo entrenado para citoplasma (ideal para la mayoría de células)</p>
</li>
<li>
<p><code>gpu=False</code>: Usa CPU en lugar de GPU (más compatible)</p>
</li>
</ul>
<h3 id="análisis-paso-a-paso">Análisis paso a paso</h3>
<h4 id="3-cargar-tu-imagen">3. Cargar tu imagen</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s2">&#34;./SUM_N1-0002.tif&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Importante:</strong> Reemplaza <code>&quot;./SUM_N1-0002.tif&quot;</code> con la ruta a tu imagen. Cellpose funciona con formatos comunes como TIFF, PNG, JPG.</p>
<h4 id="4-ejecutar-la-segmentación-automática">4. Ejecutar la segmentación automática</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">masks</span><span class="p">,</span> <span class="n">flows</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="n">diams</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">diameter</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="c1"># Diámetro estimado de las células en píxeles</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="c1"># Canal de citoplasma, canal de núcleo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Parámetros clave:</strong></p>
<ul>
<li>
<p><code>diameter=75</code>: Tamaño promedio esperado de tus células (ajusta según tu imagen)</p>
</li>
<li>
<p><code>channels=[0, 0]</code>: Para imágenes en escala de grises</p>
</li>
<li>
<p><code>channels=[1, 3]</code>: Si tienes canales específicos para citoplasma y núcleo</p>
</li>
</ul>
<p><strong>Resultados:</strong></p>
<ul>
<li>
<p><code>masks</code>: Imagen segmentada donde cada célula tiene un número único</p>
</li>
<li>
<p><code>flows</code>: Información del flujo de gradientes (para diagnóstico)</p>
</li>
<li>
<p><code>styles</code>: Estilos detectados</p>
</li>
<li>
<p><code>diams</code>: Diámetros estimados</p>
</li>
</ul>
<h4 id="5-visualizar-los-resultados">5. Visualizar los resultados</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Añadir la imagen original</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Raw image&#34;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&#34;gray&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Añadir las máscaras de segmentación</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_labels</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Cellpose masks&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>¿Qué verás?</strong></p>
<ul>
<li>
<p><strong>Imagen original</strong>: En escala de grises</p>
</li>
<li>
<p><strong>Máscaras coloreadas</strong>: Cada célula con un color diferente</p>
</li>
<li>
<p><strong>Superposición</strong>: Puedes alternar la visibilidad para comparar</p>
</li>
</ul>
<h3 id="análisis-cuantitativo">Análisis cuantitativo</h3>
<h4 id="6-extraer-medidas-de-las-células">6. Extraer medidas de las células</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">props</span> <span class="o">=</span> <span class="n">regionprops_table</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">masks</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">intensity_image</span><span class="o">=</span><span class="n">img</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">properties</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;label&#34;</span><span class="p">,</span> <span class="s2">&#34;area&#34;</span><span class="p">,</span> <span class="s2">&#34;mean_intensity&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&#34;cell_measurements.csv&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>¿Qué medidas obtienes?</strong></p>
<ul>
<li>
<p><code>label</code>: Identificador único de cada célula</p>
</li>
<li>
<p><code>area</code>: Área en píxeles</p>
</li>
<li>
<p><code>mean_intensity</code>: Intensidad promedio (brillo)</p>
</li>
</ul>
<p><strong>Otras propiedades disponibles:</strong></p>
<ul>
<li>
<p><code>perimeter</code>: Perímetro de la célula</p>
</li>
<li>
<p><code>eccentricity</code>: Qué tan alargada es la célula</p>
</li>
<li>
<p><code>solidity</code>: Qué tan sólida es la forma</p>
</li>
<li>
<p><code>centroid</code>: Centro de masa de la célula</p>
</li>
</ul>
<h4 id="7-exportar-imágenes-para-presentaciones">7. Exportar imágenes para presentaciones</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imsave</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.color</span> <span class="kn">import</span> <span class="n">label2rgb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># assume &#39;viewer&#39; already exists and has your layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&#34;output_pngs&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># sanitize layer name for filesystem</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Image layer: normalize floats to uint8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">napari</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">imsave</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Labels layer: map each integer label to a color</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">napari</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Labels</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># background=0 will be black</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rgb</span> <span class="o">=</span> <span class="n">label2rgb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bg_label</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">imsave</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="p">(</span><span class="n">rgb</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># skip Points, Shapes, Vectors, etc.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Skipping layer “</span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">” of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><h3 id="consejos-para-optimizar-resultados">Consejos para optimizar resultados</h3>
<h4 id="ajustar-el-diámetro">Ajustar el diámetro</h4>
<ul>
<li>
<p><strong>Células pequeñas</strong>: diameter=30-50</p>
</li>
<li>
<p><strong>Células medianas</strong>: diameter=50-100</p>
</li>
<li>
<p><strong>Células grandes</strong>: diameter=100-200</p>
</li>
<li>
<p><strong>Automático</strong>: diameter=None (Cellpose estimará)</p>
</li>
</ul>
<h4 id="seleccionar-el-modelo-apropiado">Seleccionar el modelo apropiado</h4>
<ul>
<li>
<p><code>&quot;cyto&quot;</code>: Células generales con citoplasma visible</p>
</li>
<li>
<p><code>&quot;nuclei&quot;</code>: Núcleos celulares</p>
</li>
<li>
<p><code>&quot;cyto2&quot;</code>: Versión mejorada para citoplasma</p>
</li>
</ul>
<h4 id="configurar-canales-correctamente">Configurar canales correctamente</h4>
<ul>
<li>
<p>Imagen en escala de grises: <code>[0, 0]</code></p>
</li>
<li>
<p>Canal rojo para citoplasma: <code>[1, 0]</code></p>
</li>
<li>
<p>Canal verde para núcleos: <code>[0, 2]</code></p>
</li>
<li>
<p>Ambos canales: <code>[1, 2]</code></p>
</li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/fhello23" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com/fhola23" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="mailto:fihf99@gmail.com" target="_blank" rel="noopener noreferrer me"
    title="Email">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2025 Francisco Hola.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
