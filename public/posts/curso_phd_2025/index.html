<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">PhD Course UAndes 2025 | FHOLA</title>
<meta property="og:title" content="PhD Course UAndes 2025 | FHOLA" />
<meta name="twitter:title" content="PhD Course UAndes 2025 | FHOLA" />
<meta itemprop="name" content="PhD Course UAndes 2025 | FHOLA" />
<meta name="application-name" content="PhD Course UAndes 2025 | FHOLA" />
<meta property="og:site_name" content="Awesome hugo blog" />

<meta name="description" content="Python and napari class guide for UAndes PhD course 2025">
<meta itemprop="description" content="Python and napari class guide for UAndes PhD course 2025" />
<meta property="og:description" content="Python and napari class guide for UAndes PhD course 2025" />
<meta name="twitter:description" content="Python and napari class guide for UAndes PhD course 2025" />

<meta property="og:locale" content="en" />
<meta name="language" content="en" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/posts/curso_phd_2025/" title="English" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2025-06-17T00:00:00Z />
    <meta property="article:published_time" content=2025-06-17T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/posts/curso_phd_2025/" />

    
    <meta property="og:article:author" content="Sidharth R" />
    <meta property="article:author" content="Sidharth R" />
    <meta name="author" content="Sidharth R" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "PhD Course UAndes 2025",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2025-06-17",
        "description": "Python and napari class guide for UAndes PhD course 2025",
        "wordCount":  3267 ,
        "mainEntityOfPage": "True",
        "dateModified": "2025-06-17",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "FHOLA"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.123.6">

    
    <meta property="og:title" content="PhD Course UAndes 2025" />
<meta property="og:description" content="Python and napari class guide for UAndes PhD course 2025" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/curso_phd_2025/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-06-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-06-17T00:00:00+00:00" />



    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="PhD Course UAndes 2025"/>
<meta name="twitter:description" content="Python and napari class guide for UAndes PhD course 2025"/>


    

    <link rel="canonical" href="http://localhost:1313/posts/curso_phd_2025/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">PhD Course UAndes 2025</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2025-06-17T00:00:00&#43;00:00" itemprop="datePublished"> Jun 17, 2025 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b></b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#python-installation--visual-studio-code--jupyter">Python Installation + Visual Studio Code + Jupyter</a>
      <ul>
        <li><a href="#python-installation">Python Installation</a></li>
        <li><a href="#visual-studio-code-vs-code-installation">Visual Studio Code (VS Code) Installation</a></li>
        <li><a href="#setting-up-vs-code-for-python">Setting up VS Code for Python</a></li>
        <li><a href="#setting-up-jupyter-notebooks-in-vs-code">Setting up Jupyter Notebooks in VS Code</a></li>
        <li><a href="#python-and-jupyter-test">Python and Jupyter Test</a></li>
      </ul>
    </li>
    <li><a href="#introduction-to-data-visualization-with-pandas-and-plotly">Introduction to Data Visualization with Pandas and Plotly</a>
      <ul>
        <li><a href="#dataset-gene-expression-in-brain-regions">Dataset: Gene Expression in Brain Regions</a></li>
        <li><a href="#initial-setup">Initial Setup</a>
          <ul>
            <li><a href="#importing-the-required-libraries">Importing the Required Libraries</a></li>
            <li><a href="#loading-the-data">Loading the Data</a></li>
          </ul>
        </li>
        <li><a href="#initial-exploration-the-first-look">Initial Exploration: The First Look</a>
          <ul>
            <li><a href="#whats-in-our-data">What&rsquo;s in Our Data?</a></li>
            <li><a href="#technical-summary-of-the-dataset">Technical Summary of the Dataset</a></li>
            <li><a href="#statistical-summary">Statistical Summary</a></li>
          </ul>
        </li>
        <li><a href="#exploratory-analysis-with-pandas">Exploratory Analysis with Pandas</a>
          <ul>
            <li><a href="#counting-occurrences">Counting Occurrences</a></li>
            <li><a href="#unique-elements">Unique Elements</a></li>
          </ul>
        </li>
        <li><a href="#data-filtering-and-selection">Data Filtering and Selection</a>
          <ul>
            <li><a href="#basic-filtering">Basic Filtering</a></li>
            <li><a href="#selection-with-loc--and-iloc">Selection with .loc  and .iloc</a></li>
            <li><a href="#advanced-indexing">Advanced Indexing</a></li>
          </ul>
        </li>
        <li><a href="#grouping-and-aggregation">Grouping and Aggregation</a>
          <ul>
            <li><a href="#averages-by-region">Averages by Region</a></li>
            <li><a href="#multiple-aggregations">Multiple Aggregations</a></li>
          </ul>
        </li>
        <li><a href="#creating-new-variables">Creating New Variables</a>
          <ul>
            <li><a href="#function-to-categorize-expression">Function to Categorize Expression</a></li>
          </ul>
        </li>
        <li><a href="#visualization-with-plotly">Visualization with Plotly</a>
          <ul>
            <li><a href="#interactive-bar-chart">Interactive Bar Chart</a></li>
            <li><a href="#distribution-histogram">Distribution Histogram</a></li>
            <li><a href="#violin-chart-distribution-by-region">Violin Chart: Distribution by Region</a></li>
            <li><a href="#heatmap-heatmap">Heatmap (Heatmap)</a></li>
          </ul>
        </li>
        <li><a href="#advanced-interactive-analysis">Advanced Interactive Analysis</a>
          <ul>
            <li><a href="#function-for-gene-analysis">Function for Gene Analysis</a></li>
            <li><a href="#top-genes-by-region">Top Genes by Region</a></li>
          </ul>
        </li>
        <li><a href="#handling-missing-data">Handling Missing Data</a></li>
        <li><a href="#additional-resources">Additional Resources</a></li>
      </ul>
    </li>
    <li><a href="#introduction-to-napari">Introduction to Napari</a>
      <ul>
        <li><a href="#what-is-napari">What is Napari?</a>
          <ul>
            <li><a href="#why-use-napari">Why use Napari?</a></li>
          </ul>
        </li>
        <li><a href="#getting-started-with-napari">Getting Started with Napari</a>
          <ul>
            <li><a href="#1-import-the-required-libraries">1. Import the required libraries</a></li>
            <li><a href="#2-create-a-viewer">2. Create a viewer</a></li>
            <li><a href="#3-load-sample-data">3. Load sample data</a></li>
            <li><a href="#4-working-with-layers">4. Working with layers</a></li>
            <li><a href="#5-examining-detailed-layer-information">5. Examining detailed layer information</a></li>
          </ul>
        </li>
        <li><a href="#important-concepts-for-biologists">Important concepts for biologists</a>
          <ul>
            <li><a href="#layers">Layers</a></li>
            <li><a href="#dimensions">Dimensions</a></li>
            <li><a href="#interactivity">Interactivity</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#working-with-lif-files-in-napari">Working with LIF Files in Napari</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#setting-up-the-environment">Setting up the Environment</a></li>
        <li><a href="#creating-a-napari-viewer">Creating a Napari Viewer</a></li>
        <li><a href="#loading-an-lif-file">Loading an LIF File</a></li>
        <li><a href="#exploring-image-dimensions">Exploring Image Dimensions</a></li>
        <li><a href="#getting-image-data">Getting Image Data</a></li>
        <li><a href="#working-with-multiple-scenes">Working with Multiple Scenes</a></li>
        <li><a href="#selecting-and-loading-a-specific-scene">Selecting and Loading a Specific Scene</a></li>
        <li><a href="#visualizing-in-napari">Visualizing in Napari</a></li>
        <li><a href="#understanding-the-napari-interface">Understanding the Napari Interface</a></li>
        <li><a href="#tips-for-working-with-multi-dimensional-data">Tips for Working with Multi-dimensional Data</a></li>
      </ul>
    </li>
    <li><a href="#napari--cellpose-automatic-cell-segmentation">Napari + Cellpose: Automatic Cell Segmentation</a>
      <ul>
        <li><a href="#what-is-cellpose">What is Cellpose?</a>
          <ul>
            <li><a href="#why-combine-napari-with-cellpose">Why combine Napari with Cellpose?</a></li>
          </ul>
        </li>
        <li><a href="#environment-preparation">Environment Preparation</a>
          <ul>
            <li><a href="#1-import-the-required-libraries-1">1. Import the required libraries</a></li>
            <li><a href="#2-create-the-viewer-and-load-the-model">2. Create the viewer and load the model</a></li>
          </ul>
        </li>
        <li><a href="#step-by-step-analysis">Step-by-step Analysis</a>
          <ul>
            <li><a href="#3-load-your-image">3. Load your image</a></li>
            <li><a href="#4-run-automatic-segmentation">4. Run automatic segmentation</a></li>
            <li><a href="#5-visualize-the-results">5. Visualize the results</a></li>
          </ul>
        </li>
        <li><a href="#quantitative-analysis">Quantitative Analysis</a>
          <ul>
            <li><a href="#6-extract-cell-measurements">6. Extract cell measurements</a></li>
            <li><a href="#7-export-images-for-presentations">7. Export images for presentations</a></li>
          </ul>
        </li>
        <li><a href="#tips-for-optimizing-results">Tips for optimizing results</a>
          <ul>
            <li><a href="#adjusting-diameter">Adjusting diameter</a></li>
            <li><a href="#selecting-the-appropriate-model">Selecting the appropriate model</a></li>
            <li><a href="#configuring-channels-correctly">Configuring channels correctly</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <h2 id="python-installation--visual-studio-code--jupyter">Python Installation + Visual Studio Code + Jupyter</h2>
<p>I cover installation for both Windows and Mac in a video published at the following <a href="https://youtu.be/zJJ92NXcPc0">link</a>. If you prefer a written version, I&rsquo;m leaving this instruction below:</p>
<h3 id="python-installation">Python Installation</h3>
<p>Python is a versatile programming language. We&rsquo;ll install the latest stable version.</p>
<p><strong>Download Python:</strong></p>
<ul>
<li>
<p>Open your web browser and go to the official Python website: <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
</li>
<li>
<p>The website should automatically detect your operating system (Windows or macOS) and suggest the appropriate installer. Click the download button for the latest version (for example, Python 3.12.x or later).</p>
</li>
</ul>
<p><strong>Install Python:</strong></p>
<ul>
<li><strong>For Windows Users:</strong></li>
</ul>
<ol>
<li>Run the <code>.exe</code> installer downloaded.</li>
<li><strong>Crucial Step:</strong> On the first screen of the installer, make sure to check the box that says <strong>&ldquo;Add Python to PATH&rdquo;</strong> or <strong>&ldquo;Add python.exe to PATH&rdquo;</strong>. This will make it easy to run Python from the command line.</li>
<li>Click <strong>&ldquo;Install Now&rdquo;</strong> (this usually includes pip, IDLE and other standard features).</li>
<li>Follow the on-screen instructions to complete the installation.</li>
<li>Once installed, you might see an option to &ldquo;Disable path length limit&rdquo;. Click this if it&rsquo;s available, as it can prevent issues with long file paths.</li>
</ol>
<ul>
<li><strong>For macOS Users:</strong></li>
</ul>
<ol>
<li>Run the <code>.pkg</code> installer downloaded.</li>
<li>Follow the on-screen instructions. Python on macOS usually installs without problems. It will install in <code>/usr/local/bin/python3</code>.</li>
<li>The installer should also install <code>pip</code> (the Python package installer) and <code>IDLE</code> (the basic Integrated Development Environment of Python).</li>
</ol>
<p><strong>Verify Python Installation:</strong></p>
<ul>
<li>
<p>Once installation is complete, you need to verify it.</p>
</li>
<li>
<p><strong>For Windows:</strong></p>
</li>
</ul>
<ol>
<li>Open the Command Prompt (search for &ldquo;cmd&rdquo; in the Start Menu).</li>
<li>Type <code>python --version</code> and press Enter.</li>
<li>Type <code>pip --version</code> and press Enter.</li>
</ol>
<p>You should see the Python and pip versions printed, respectively.</p>
<ul>
<li><strong>For macOS:</strong></li>
</ul>
<ol>
<li>Open Terminal (you can find it in Applications &gt; Utilities, or search for it using Spotlight).</li>
<li>Type <code>python3 --version</code> and press Enter.</li>
<li>Type <code>pip3 --version</code> and press Enter.</li>
</ol>
<p>You should see the Python and pip versions printed. (Note: macOS often comes with an older version of Python 2, so <code>python3</code> and <code>pip3</code> are typically used to specify the version you just installed).</p>
<p>If you see version numbers, Python is installed correctly! If not, try restarting your computer and checking again. If problems persist, you might need to reinstall, making sure to have added Python to PATH in Windows.</p>
<h3 id="visual-studio-code-vs-code-installation">Visual Studio Code (VS Code) Installation</h3>
<p>VS Code is a lightweight but powerful source code editor that runs on your desktop and is available for Windows, macOS and Linux. It has excellent support for Python development.</p>
<p><strong>Download VS Code:</strong></p>
<ul>
<li>Go to the official VS Code website: <a href="https://code.visualstudio.com/download">https://code.visualstudio.com/download</a></li>
<li>Download the installer for your operating system (Windows or macOS).</li>
</ul>
<p><strong>Install VS Code:</strong></p>
<ul>
<li><strong>For Windows:</strong></li>
</ul>
<ol>
<li>Run the <code>.exe</code> installer downloaded.</li>
<li>Accept the agreement and follow the on-screen instructions.</li>
<li>It&rsquo;s recommended to keep the default settings, especially <strong>&ldquo;Add to PATH&rdquo;</strong> (if offered as an option during installation, make sure it&rsquo;s checked).</li>
<li>You might also want to check the &ldquo;Open with Code&rdquo; actions for the context menu of Windows Explorer files and directories for convenience.</li>
</ol>
<ul>
<li><strong>For macOS:</strong></li>
</ul>
<ol>
<li>Run the downloaded <code>.dmg</code> file.</li>
<li>Drag the &ldquo;Visual Studio Code.app&rdquo; icon to your &ldquo;Applications&rdquo; folder.</li>
</ol>
<p><strong>Start VS Code:</strong></p>
<ul>
<li>Open VS Code from your Applications folder (macOS) or Start Menu (Windows).</li>
</ul>
<h3 id="setting-up-vs-code-for-python">Setting up VS Code for Python</h3>
<p>Now, let&rsquo;s set up VS Code to work with Python.</p>
<p><strong>Install the Python Extension:</strong></p>
<ul>
<li>In VS Code, go to the <strong>Extensions View</strong> by clicking the squares icon in the left sidebar (or press <code>Ctrl+Shift+X</code> on Windows, <code>Cmd+Shift+X</code> on macOS).</li>
<li>In the search bar, type <code>Python</code>.</li>
<li>Look for the extension called <strong>&ldquo;Python&rdquo;</strong> published by <strong>Microsoft</strong>. It&rsquo;s usually the first result and has millions of downloads.</li>
<li>Click the <strong>&ldquo;Install&rdquo;</strong> button for this extension.</li>
</ul>
<h3 id="setting-up-jupyter-notebooks-in-vs-code">Setting up Jupyter Notebooks in VS Code</h3>
<p>Jupyter Notebooks are interactive documents that allow you to write and execute code, add text, equations, visualizations and more. VS Code has excellent built-in support for Jupyter Notebooks.</p>
<p><strong>Install the Jupyter Extension:</strong></p>
<ul>
<li>Just like you installed the Python extension, go to the <strong>Extensions View</strong> (<code>Ctrl+Shift+X</code> or <code>Cmd+Shift+X</code>).</li>
<li>Search for <code>Jupyter</code>.</li>
<li>Install the <strong>&ldquo;Jupyter&rdquo;</strong> extension published by <strong>Microsoft</strong>. (Often, this is installed as a dependency of the Python extension, but it&rsquo;s good to check).</li>
</ul>
<p><strong>Create or Open a Jupyter Notebook:</strong></p>
<ul>
<li>Create a test file, called <code>test.ipynb</code>. This is the extension name for jupyter notebooks.</li>
</ul>
<p><strong>Select a Kernel:</strong></p>
<ul>
<li>The notebook will need to connect to a Python &ldquo;kernel&rdquo; to run code.</li>
<li>Usually, in the top right corner of the notebook interface, you&rsquo;ll see an option to &ldquo;Select Kernel&rdquo;.</li>
<li>Click there and choose the Python environment you set up earlier (the same one you selected as your Python interpreter).</li>
<li>If you&rsquo;re prompted to install <code>ipykernel</code> or other packages, let the extension do it.</li>
</ul>
<p><strong>Use the Notebook:</strong></p>
<ul>
<li>A notebook is made of &ldquo;cells&rdquo;.</li>
<li><strong>Code cells:</strong> Where you write and run Python code. Write your code and press <code>Shift+Enter</code> (or click the play button next to the cell) to run it.</li>
<li><strong>Markdown cells:</strong> Where you can write text, like this guide. You can change the cell type using the dropdown menu in the notebook toolbar.</li>
</ul>
<hr>
<h3 id="python-and-jupyter-test">Python and Jupyter Test</h3>
<p>Let&rsquo;s make sure everything works.</p>
<p><strong>Simple Python Script in VS Code:</strong></p>
<ul>
<li>Create a new file in VS Code (File &gt; New File or Archivo &gt; Nuevo Archivo).</li>
<li>Save it as <code>hello.py</code>.</li>
<li>Write the following Python code:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Hello, from a Python script!&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>Save the file (<code>Ctrl+S</code> or <code>Cmd+S</code>).</li>
<li>Right-click in the editor and select &ldquo;Run Python File in Terminal&rdquo; (Ejecutar Archivo Python en Terminal) or click the play button in the top right corner of the VS Code window.</li>
<li>You should see the message printed in the terminal panel of VS Code.</li>
</ul>
<p><strong>Simple Jupyter Notebook Test:</strong></p>
<ul>
<li>If you don&rsquo;t have a Jupyter Notebook open, create one (<code>Jupyter: Create New Jupyter Notebook</code> from the Command Palette).</li>
<li>In the first code cell, write:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;Hello from a Jupyter Notebook cell!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>Press <code>Shift+Enter</code> to run the cell.</li>
<li>You should see the output <code>Hello from a Jupyter Notebook cell!</code> displayed directly below the cell.</li>
</ul>
<h2 id="introduction-to-data-visualization-with-pandas-and-plotly">Introduction to Data Visualization with Pandas and Plotly</h2>
<p>Modern data science requires powerful tools for analyzing and visualizing information. In this complete tutorial, we&rsquo;ll explore two of the most important libraries in the Python data analysis ecosystem: <strong>Pandas</strong> for data manipulation and <strong>Plotly</strong> for interactive visualizations.</p>
<h3 id="dataset-gene-expression-in-brain-regions">Dataset: Gene Expression in Brain Regions</h3>
<p>For this section we will use a real dataset from the <strong>Human Protein Atlas</strong> that contains information about gene expression in different regions of the human brain. This type of data is crucial for understanding how genes work in different parts of the brain.</p>
<h3 id="initial-setup">Initial Setup</h3>
<h4 id="importing-the-required-libraries">Importing the Required Libraries</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span></code></pre></div><p><strong>Why these libraries?</strong></p>
<ul>
<li>
<p><strong>Pandas</strong>: The fundamental tool for data manipulation in Python</p>
</li>
<li>
<p><strong>Plotly Express</strong>: To create quick and interactive visualizations</p>
</li>
<li>
<p><strong>Plotly Graph Objects</strong>: For more customized visualizations</p>
</li>
<li>
<p><strong>NumPy</strong>: For mathematical operations and array handling</p>
</li>
</ul>
<h4 id="loading-the-data">Loading the Data</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rna_brain_region_hpa.csv&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="initial-exploration-the-first-look">Initial Exploration: The First Look</h3>
<h4 id="whats-in-our-data">What&rsquo;s in Our Data?</h4>
<p>Before analyzing, we need to understand what we&rsquo;re dealing with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Show the first 10 rows</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="technical-summary-of-the-dataset">Technical Summary of the Dataset</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># General information about the dataset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>What does this tell us?</strong></p>
<ul>
<li>
<p>Total number of rows and columns</p>
</li>
<li>
<p>Data types in each column</p>
</li>
<li>
<p>Null values (if any)</p>
</li>
<li>
<p>Memory usage</p>
</li>
</ul>
<h4 id="statistical-summary">Statistical Summary</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Descriptive statistics</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>Key information:</strong></p>
<ul>
<li>Central tendency measures (mean, median)</li>
<li>Data dispersion (standard deviation)</li>
<li>Minimum and maximum values</li>
<li>Percentiles (25%, 50%, 75%)</li>
</ul>
<h3 id="exploratory-analysis-with-pandas">Exploratory Analysis with Pandas</h3>
<h4 id="counting-occurrences">Counting Occurrences</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># How many samples do we have per brain region?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="unique-elements">Unique Elements</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique genes: </span><span class="si">{</span><span class="n">brain_data</span><span class="p">[</span><span class="s2">&#34;Gene name&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique brain regions: </span><span class="si">{</span><span class="n">brain_data</span><span class="p">[</span><span class="s2">&#34;Brain region&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="data-filtering-and-selection">Data Filtering and Selection</h3>
<h4 id="basic-filtering">Basic Filtering</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Filter data only from the cerebellum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cerebellum</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cerebellum&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Genes with high expression (TPM &gt; 100)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">high_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;TPM&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>
</span></span></code></pre></div><h4 id="selection-with-loc--and-iloc">Selection with .loc  and .iloc</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Label-based selection</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">specific_gene</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TNMD&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Position-based selection</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">first_rows_cols</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span></span></code></pre></div><h4 id="advanced-indexing">Advanced Indexing</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create multi-level index</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_indexed</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span> <span class="s1">&#39;Brain region&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Access specific data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gene_tpm</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;TNMD&#39;</span><span class="p">,</span> <span class="s1">&#39;cerebellum&#39;</span><span class="p">),</span> <span class="s1">&#39;TPM&#39;</span><span class="p">]</span>
</span></span></code></pre></div><h3 id="grouping-and-aggregation">Grouping and Aggregation</h3>
<h4 id="averages-by-region">Averages by Region</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Average expression by brain region</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">avg_expression_by_region</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="multiple-aggregations">Multiple Aggregations</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Median and sum by region</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">median_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sum_expression</span> <span class="o">=</span> <span class="n">brain_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Brain region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="creating-new-variables">Creating New Variables</h3>
<h4 id="function-to-categorize-expression">Function to Categorize Expression</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">expression_level</span><span class="p">(</span><span class="n">tpm</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">tpm</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;Low&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="n">tpm</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;Medium&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="s1">&#39;High&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Apply the function</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;expression_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;TPM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">expression_level</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="visualization-with-plotly">Visualization with Plotly</h3>
<h4 id="interactive-bar-chart">Interactive Bar Chart</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gene</span> <span class="o">=</span> <span class="s2">&#34;GFAP&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_filtered_by_gene</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gene</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_filtered_by_gene</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Expression of </span><span class="si">{</span><span class="n">gene</span><span class="si">}</span><span class="s1"> in Different Brain Regions&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TPM&#39;</span><span class="p">:</span> <span class="s1">&#39;TPM (Transcripts Per Million)&#39;</span><span class="p">,</span> <span class="s1">&#39;Brain region&#39;</span><span class="p">:</span> <span class="s1">&#39;Brain Region&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span> <span class="c1"># Rotate the x-axis labels for better readability</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="distribution-histogram">Distribution Histogram</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">brain_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution of Gene Expression (TPM)&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;TPM&#39;</span><span class="p">:</span> <span class="s1">&#39;TPM (Transcripts Per Million)&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Use a logarithmic scale on the y-axis to see the full range</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nbins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Increase the number of &#34;bins&#34; or intervals for more detail</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="violin-chart-distribution-by-region">Violin Chart: Distribution by Region</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">violin</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brain_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Expression Distribution by Brain Region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">box</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="heatmap-heatmap">Heatmap (Heatmap)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Select genes of interest</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">genes_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OLIG2&#39;</span><span class="p">,</span> <span class="s1">&#39;RBM6&#39;</span><span class="p">,</span> <span class="s1">&#39;GDE1&#39;</span><span class="p">,</span> <span class="s1">&#39;TSPAN6&#39;</span><span class="p">,</span> <span class="s1">&#39;CYP51A1&#39;</span><span class="p">,</span> <span class="s1">&#39;HS3ST1&#39;</span><span class="p">,</span> <span class="s1">&#39;SPAST&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">heatmap_df</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">genes_of_interest</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># We need to &#34;pivot&#34; the table to get the correct shape for a heatmap</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">heatmap_pivot</span> <span class="o">=</span> <span class="n">heatmap_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;nTPM&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">heatmap_pivot</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Heatmap of Neuronal Marker Gene Expression&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&#34;Brain Region&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&#34;Gene Name&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;nTPM&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">color_continuous_scale</span><span class="o">=</span><span class="s2">&#34;plasma&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># zmin=0, # Set lower limit of scale</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># zmax=100 # Set upper limit of scale</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="advanced-interactive-analysis">Advanced Interactive Analysis</h3>
<h4 id="function-for-gene-analysis">Function for Gene Analysis</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">analyze_gene</span><span class="p">(</span><span class="n">gene</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">	<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Gene name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">gene</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Gene &#39;</span><span class="si">{</span><span class="n">gene</span><span class="si">}</span><span class="s2">&#39; not found in dataset&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="n">df_filtered</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">x</span><span class="o">=</span><span class="s1">&#39;Brain region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Expression of Gene </span><span class="si">{</span><span class="n">gene</span><span class="si">}</span><span class="s1"> by Brain Region&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">color</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">df_filtered</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Example usage</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">analyze_gene</span><span class="p">(</span><span class="s1">&#39;ACTB&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="top-genes-by-region">Top Genes by Region</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">top_genes_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">	
</span></span></span><span class="line"><span class="cl"><span class="s2">	Find the most expressed genes in a specific region
</span></span></span><span class="line"><span class="cl"><span class="s2">	
</span></span></span><span class="line"><span class="cl"><span class="s2">	&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">top_genes</span> <span class="o">=</span> <span class="n">brain_data</span><span class="p">[</span><span class="n">brain_data</span><span class="p">[</span><span class="s1">&#39;Brain region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>\
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pTPM&#39;</span><span class="p">,</span> <span class="s1">&#39;TPM&#39;</span><span class="p">,</span> <span class="s1">&#39;nTPM&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">top_genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">x</span><span class="o">=</span><span class="s1">&#39;Gene name&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">y</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> Most Expressed Genes in </span><span class="si">{</span><span class="n">region</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">color</span><span class="o">=</span><span class="s1">&#39;TPM&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">top_genes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Example</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">top_cerebellum</span> <span class="o">=</span> <span class="n">top_genes_region</span><span class="p">(</span><span class="s1">&#39;cerebellum&#39;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="handling-missing-data">Handling Missing Data</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check for null data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Null data by column:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">brain_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># In case of null data:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># brain_data.dropna() # Remove rows with null values</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># brain_data.fillna(0) # Replace with 0</span>
</span></span></code></pre></div><h3 id="additional-resources">Additional Resources</h3>
<ul>
<li>
<p><a href="https://pandas.pydata.org/docs/">Official Pandas Documentation</a></p>
</li>
<li>
<p><a href="https://plotly.com/python/">Plotly Examples Gallery</a></p>
</li>
<li>
<p><a href="https://www.proteinatlas.org/">Human Protein Atlas</a></p>
</li>
</ul>
<h2 id="introduction-to-napari">Introduction to Napari</h2>
<h3 id="what-is-napari">What is Napari?</h3>
<p>Napari is a fast, interactive, multidimensional visualization tool for Python, especially designed for scientific data. It&rsquo;s perfect for analyzing biological images like microscopy, fluorescence data, and any type of scientific image in 2D, 3D or even higher dimensions.</p>
<h4 id="why-use-napari">Why use Napari?</h4>
<ul>
<li>
<p><strong>Interactive</strong>: You can explore your data visually and interactively</p>
</li>
<li>
<p><strong>Multidimensional</strong>: Handles 2D, 3D, 4D and more dimensions</p>
</li>
<li>
<p><strong>Extensible</strong>: Compatible with many image analysis tools</p>
</li>
<li>
<p><strong>Easy to use</strong>: Intuitive interface for scientists</p>
</li>
</ul>
<h3 id="getting-started-with-napari">Getting Started with Napari</h3>
<h4 id="1-import-the-required-libraries">1. Import the required libraries</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.filters</span> <span class="kn">import</span> <span class="n">threshold_otsu</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.segmentation</span> <span class="kn">import</span> <span class="n">clear_border</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">regionprops_table</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="kn">import</span> <span class="n">closing</span><span class="p">,</span> <span class="n">square</span><span class="p">,</span> <span class="n">remove_small_objects</span>
</span></span></code></pre></div><p><strong>Explanation:</strong></p>
<ul>
<li>
<p><code>napari</code>: The main library for visualization</p>
</li>
<li>
<p><code>skimage</code>: Image processing library (scikit-image)</p>
</li>
<li>
<p><code>numpy</code>: For array handling and numerical data</p>
</li>
</ul>
<h4 id="2-create-a-viewer">2. Create a viewer</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span></code></pre></div><p>This command opens an interactive window where you&rsquo;ll be able to visualize and manipulate your data. It&rsquo;s like opening a digital microscope on your computer.</p>
<h4 id="3-load-sample-data">3. Load sample data</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">cells3d</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cells&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>What does this code do?</strong></p>
<ul>
<li>
<p><code>data.cells3d()</code>: Loads an example dataset containing 3D cells</p>
</li>
<li>
<p><code>add_image()</code>: Adds the image to the viewer</p>
</li>
<li>
<p><code>name='cells'</code>: Gives it a descriptive name to the layer</p>
</li>
</ul>
<h4 id="4-working-with-layers">4. Working with layers</h4>
<p>In Napari, each visual element is a &ldquo;layer&rdquo; or &ldquo;layer&rdquo;. You can have multiple layers overlaid. You can add points from the GUI for example and we&rsquo;ll be able to access them from our notebook:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get all layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">layers</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Expected result:</strong></p>
<pre tabindex="0"><code>
[&lt;Image layer &#39;cells&#39; at 0x35ca7d040&gt;,

  

&lt;Points layer &#39;Points&#39; at 0x355315eb0&gt;,

  
</code></pre><h4 id="5-examining-detailed-layer-information">5. Examining detailed layer information</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Select a specific layer (in this case, the points layer)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">points_layer</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get detailed information</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Layer name: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Layer type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">points_layer</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Data shape: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Data type: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Number of points: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Visibility: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">visible</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Opacity: </span><span class="si">{</span><span class="n">points_layer</span><span class="o">.</span><span class="n">opacity</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View point coordinates</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Point coordinates:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">points_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Expected result:</strong></p>
<pre tabindex="0"><code>
Layer name: Points

  

Layer type: &lt;class &#39;napari.layers.points.points.Points&#39;&gt;

  

Data shape: (4, 4)

  

Data type: float64

  

Number of points: 4

  

Visibility: True

  

Opacity: 1.0

  

  

Point coordinates:

  

[List with coordinates of added points]

  
</code></pre><h3 id="important-concepts-for-biologists">Important concepts for biologists</h3>
<h4 id="layers">Layers</h4>
<ul>
<li>
<p><strong>Image layers</strong>: To display images (microscopy, fluorescence, etc.)</p>
</li>
<li>
<p><strong>Points layers</strong>: To mark specific points (cells, organelles, etc.)</p>
</li>
<li>
<p><strong>Labels layers</strong>: For segmentation and regions of interest</p>
</li>
<li>
<p><strong>Shapes layers</strong>: To draw geometric shapes</p>
</li>
</ul>
<h4 id="dimensions">Dimensions</h4>
<ul>
<li>
<p><strong>2D</strong>: Simple images (x, y)</p>
</li>
<li>
<p><strong>3D</strong>: Image stacks or volumes (z, y, x)</p>
</li>
<li>
<p><strong>4D</strong>: Time series (t, z, y, x)</p>
</li>
<li>
<p><strong>Multi-channel</strong>: Different fluorescence channels</p>
</li>
</ul>
<h4 id="interactivity">Interactivity</h4>
<ul>
<li>
<p>Use the mouse to navigate through images</p>
</li>
<li>
<p>Zoom and pan controls</p>
</li>
<li>
<p>Contrast and brightness adjustment</p>
</li>
<li>
<p>3D layer navigation</p>
</li>
</ul>
<h2 id="working-with-lif-files-in-napari">Working with LIF Files in Napari</h2>
<h3 id="prerequisites">Prerequisites</h3>
<p>Before starting, make sure you have the necessary packages installed:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pip install napari aicsimageio scikit-image
</span></span></code></pre></div><h3 id="setting-up-the-environment">Setting up the Environment</h3>
<p>First, let&rsquo;s import the required libraries:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">aicsimageio</span> <span class="kn">import</span> <span class="n">AICSImage</span>
</span></span></code></pre></div><h3 id="creating-a-napari-viewer">Creating a Napari Viewer</h3>
<p>Start by creating a napari viewer instance:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span></code></pre></div><p>This opens the napari interface where we&rsquo;ll visualize our image data.</p>
<h3 id="loading-an-lif-file">Loading an LIF File</h3>
<p>Load your LIF file using AICSImage:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">AICSImage</span><span class="p">(</span><span class="s2">&#34;./lif_test.lif&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>Replace <code>&quot;./lif_test.lif&quot;</code> with the path to your LIF file.</p>
<h3 id="exploring-image-dimensions">Exploring Image Dimensions</h3>
<p>Check the dimensions of your loaded image:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span></span></code></pre></div><p>This will show something like:</p>
<pre tabindex="0"><code>
&lt;Dimensions [T: 1, C: 4, Z: 8, Y: 512, X: 512]&gt;
</code></pre><h3 id="getting-image-data">Getting Image Data</h3>
<p>Extract the image data for analysis:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span></code></pre></div><p>The <code>&quot;CZYX&quot;</code> parameter specifies the order of dimensions:</p>
<ul>
<li>
<p><strong>C</strong>: Channels first</p>
</li>
<li>
<p><strong>Z</strong>: Z planes second</p>
</li>
<li>
<p><strong>Y</strong>: Height third</p>
</li>
<li>
<p><strong>X</strong>: Width fourth</p>
</li>
</ul>
<h3 id="working-with-multiple-scenes">Working with Multiple Scenes</h3>
<p>LIF files often contain multiple scenes (different fields of view or experimental conditions). Let&rsquo;s explore what&rsquo;s available:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print all available scenes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Total number of series in file: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>This will show you all scene names in your LIF file, like:</p>
<pre tabindex="0"><code>
(&#39;LPS SYN settings&#39;, &#39;LPS SYN 0&#39;, &#39;LPS SYN 1.1&#39;, &#39;LPS SYN 1.2&#39;, ...)

Total number of series in file: 119
</code></pre><h3 id="selecting-and-loading-a-specific-scene">Selecting and Loading a Specific Scene</h3>
<p>Choose a specific scene to work with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Select a scene by index</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scene_index</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Change this to load different scenes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">selected_scene</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="n">scene_index</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Selected scene: </span><span class="si">{</span><span class="n">selected_scene</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Set the current scene in the AICSImage object</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">scene_index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get the image data for the selected scene</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print dimensions for this scene</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Total number of channels C: </span><span class="si">{</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Total number of Z planes: </span><span class="si">{</span><span class="n">image_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="visualizing-in-napari">Visualizing in Napari</h3>
<p>Finally, load the image data into napari for visualization:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Clear any previous layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add the image with appropriate channel and z-plane organization</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">image_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># The first dimension (C) is the channel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;Scene: </span><span class="si">{</span><span class="n">selected_scene</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">scale</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># Scale for Z, Y, X dimensions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><h3 id="understanding-the-napari-interface">Understanding the Napari Interface</h3>
<p>Once loaded, you&rsquo;ll see:</p>
<ol>
<li>
<p><strong>Channel Controls</strong>: Sliders and controls for each channel (C dimension)</p>
</li>
<li>
<p><strong>Z-stack Navigation</strong>: Slider to navigate through different focal planes (Z dimension)</p>
</li>
<li>
<p><strong>Individual Channel Layers</strong>: Each channel appears as a separate layer in the layer list</p>
</li>
<li>
<p><strong>Visualization Controls</strong>: Contrast, colormap and blending options for each channel</p>
</li>
</ol>
<h3 id="tips-for-working-with-multi-dimensional-data">Tips for Working with Multi-dimensional Data</h3>
<ol>
<li><strong>Channel Visualization</strong>: Each channel is displayed as a separate layer, allowing you to:</li>
</ol>
<ul>
<li>
<p>Turn channels on/off</p>
</li>
<li>
<p>Adjust contrast and brightness individually</p>
</li>
<li>
<p>Change color maps for better visualization</p>
</li>
</ul>
<ol start="2">
<li>
<p><strong>Z-stack Navigation</strong>: Use the z slider to navigate through different focal planes</p>
</li>
<li>
<p><strong>Scene Comparison</strong>: To compare different scenes:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Load multiple scenes for comparison</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]:</span> <span class="c1"># Example scene indices</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="o">.</span><span class="n">set_scene</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">(</span><span class="s2">&#34;CZYX&#34;</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;Scene: </span><span class="si">{</span><span class="n">img</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ol start="4">
<li><strong>Memory Management</strong>: For large files with many scenes:</li>
</ol>
<ul>
<li>
<p>Load scenes individually rather than all at once</p>
</li>
<li>
<p>Clear the viewer between scenes if needed: <code>viewer.layers.clear()</code></p>
</li>
</ul>
<h2 id="napari--cellpose-automatic-cell-segmentation">Napari + Cellpose: Automatic Cell Segmentation</h2>
<h3 id="what-is-cellpose">What is Cellpose?</h3>
<p>Cellpose is an AI tool developed specifically for automatic cell segmentation in microscopy images. It uses neural networks trained to identify and delineate individual cells, even in complex images with overlapping cells or irregular shapes.</p>
<h4 id="why-combine-napari-with-cellpose">Why combine Napari with Cellpose?</h4>
<ul>
<li>
<p><strong>Automation</strong>: Automatic segmentation without manual adjustment</p>
</li>
<li>
<p><strong>Accuracy</strong>: Models trained with thousands of biological images</p>
</li>
<li>
<p><strong>Visualization</strong>: Napari allows you to visualize and validate segmentation results</p>
</li>
<li>
<p><strong>Quantitative Analysis</strong>: Automatic extraction of measurements and cellular properties</p>
</li>
<li>
<p><strong>Export</strong>: Save results for further analysis</p>
</li>
</ul>
<h3 id="environment-preparation">Environment Preparation</h3>
<h4 id="1-import-the-required-libraries-1">1. Import the required libraries</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">ssl</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">cellpose</span> <span class="kn">import</span> <span class="n">models</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">regionprops_table</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Explanation:</strong></p>
<ul>
<li>
<p><code>ssl</code>: Configuration to download Cellpose models</p>
</li>
<li>
<p><code>napari</code>: Interactive visualization</p>
</li>
<li>
<p><code>skimage.io</code>: Image reading</p>
</li>
<li>
<p><code>cellpose.models</code>: Automatic segmentation models</p>
</li>
<li>
<p><code>pandas</code>: Handling tabular data</p>
</li>
<li>
<p><code>regionprops_table</code>: Calculation of region properties</p>
</li>
</ul>
<h4 id="2-create-the-viewer-and-load-the-model">2. Create the viewer and load the model</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create the Napari viewer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari</span><span class="o">.</span><span class="n">Viewer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configure and load the Cellpose model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Cellpose</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="s2">&#34;cyto&#34;</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>What does this code do?</strong></p>
<ul>
<li>
<p><code>napari.Viewer()</code>: Opens the graphical interface</p>
</li>
<li>
<p><code>model_type=&quot;cyto&quot;</code>: Uses the model trained for cytoplasm (ideal for most cells)</p>
</li>
<li>
<p><code>gpu=False</code>: Uses CPU instead of GPU (more compatible)</p>
</li>
</ul>
<h3 id="step-by-step-analysis">Step-by-step Analysis</h3>
<h4 id="3-load-your-image">3. Load your image</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s2">&#34;./SUM_N1-0002.tif&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Important:</strong> Replace <code>&quot;./SUM_N1-0002.tif&quot;</code> with the path to your image. Cellpose works with common formats like TIFF, PNG, JPG.</p>
<h4 id="4-run-automatic-segmentation">4. Run automatic segmentation</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">masks</span><span class="p">,</span> <span class="n">flows</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="n">diams</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">diameter</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="c1"># Estimated diameter of cells in pixels</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="c1"># Cytoplasm channel, nucleus channel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>Key parameters:</strong></p>
<ul>
<li>
<p><code>diameter=75</code>: Average expected size of your cells (adjust according to your image)</p>
</li>
<li>
<p><code>channels=[0, 0]</code>: For grayscale images</p>
</li>
<li>
<p><code>channels=[1, 3]</code>: If you have specific channels for cytoplasm and nucleus</p>
</li>
</ul>
<p><strong>Results:</strong></p>
<ul>
<li>
<p><code>masks</code>: Segmented image where each cell has a unique number</p>
</li>
<li>
<p><code>flows</code>: Gradient flow information (for diagnosis)</p>
</li>
<li>
<p><code>styles</code>: Detected styles</p>
</li>
<li>
<p><code>diams</code>: Estimated diameters</p>
</li>
</ul>
<h4 id="5-visualize-the-results">5. Visualize the results</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add the original image</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Raw image&#34;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&#34;gray&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add the segmentation masks</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">viewer</span><span class="o">.</span><span class="n">add_labels</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;Cellpose masks&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>What will you see?</strong></p>
<ul>
<li>
<p><strong>Original image</strong>: In grayscale</p>
</li>
<li>
<p><strong>Colored masks</strong>: Each cell with a different color</p>
</li>
<li>
<p><strong>Overlay</strong>: You can toggle visibility to compare</p>
</li>
</ul>
<h3 id="quantitative-analysis">Quantitative Analysis</h3>
<h4 id="6-extract-cell-measurements">6. Extract cell measurements</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">props</span> <span class="o">=</span> <span class="n">regionprops_table</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">masks</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">intensity_image</span><span class="o">=</span><span class="n">img</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">properties</span><span class="o">=</span><span class="p">(</span><span class="s2">&#34;label&#34;</span><span class="p">,</span> <span class="s2">&#34;area&#34;</span><span class="p">,</span> <span class="s2">&#34;mean_intensity&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&#34;cell_measurements.csv&#34;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><p><strong>What measurements do you get?</strong></p>
<ul>
<li>
<p><code>label</code>: Unique identifier for each cell</p>
</li>
<li>
<p><code>area</code>: Area in pixels</p>
</li>
<li>
<p><code>mean_intensity</code>: Average intensity (brightness)</p>
</li>
</ul>
<p><strong>Other available properties:</strong></p>
<ul>
<li>
<p><code>perimeter</code>: Cell perimeter</p>
</li>
<li>
<p><code>eccentricity</code>: How elongated the cell is</p>
</li>
<li>
<p><code>solidity</code>: How solid the shape is</p>
</li>
<li>
<p><code>centroid</code>: Center of mass of the cell</p>
</li>
</ul>
<h4 id="7-export-images-for-presentations">7. Export images for presentations</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imsave</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">skimage.color</span> <span class="kn">import</span> <span class="n">label2rgb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">napari</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># assume &#39;viewer&#39; already exists and has your layers</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&#34;output_pngs&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># sanitize layer name for filesystem</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">name</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="s2">&#34;_&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Image layer: normalize floats to uint8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">napari</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">img</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">imsave</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Labels layer: map each integer label to a color</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">napari</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Labels</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># background=0 will be black</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rgb</span> <span class="o">=</span> <span class="n">label2rgb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bg_label</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">imsave</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="p">(</span><span class="n">rgb</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># skip Points, Shapes, Vectors, etc.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Skipping layer </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></div><h3 id="tips-for-optimizing-results">Tips for optimizing results</h3>
<h4 id="adjusting-diameter">Adjusting diameter</h4>
<ul>
<li>
<p><strong>Small cells</strong>: diameter=30-50</p>
</li>
<li>
<p><strong>Medium cells</strong>: diameter=50-100</p>
</li>
<li>
<p><strong>Large cells</strong>: diameter=100-200</p>
</li>
<li>
<p><strong>Automatic</strong>: diameter=None (Cellpose will estimate)</p>
</li>
</ul>
<h4 id="selecting-the-appropriate-model">Selecting the appropriate model</h4>
<ul>
<li>
<p><code>&quot;cyto&quot;</code>: General cells with visible cytoplasm</p>
</li>
<li>
<p><code>&quot;nuclei&quot;</code>: Cell nuclei</p>
</li>
<li>
<p><code>&quot;cyto2&quot;</code>: Enhanced version for cytoplasm</p>
</li>
</ul>
<h4 id="configuring-channels-correctly">Configuring channels correctly</h4>
<ul>
<li>
<p>Grayscale image: <code>[0, 0]</code></p>
</li>
<li>
<p>Red channel for cytoplasm: <code>[1, 0]</code></p>
</li>
<li>
<p>Green channel for nuclei: <code>[0, 2]</code></p>
</li>
<li>
<p>Both channels: <code>[1, 2]</code></p>
</li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
         2025 Sidharth R.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
